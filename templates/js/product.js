var rate_clicked = 0,	gst_applied = false,	qty_clicked = false,	clear_clicked = false,	image_popup_clicked = false,	lbl_buy1click = "{lng[Enter your phone number]}";(function($) {"use strict";  $(document).ready(function() {	if (!$('body').hasClass('admin-area'))		product_clicks();  });})($);var social_loaded = false;function load_social() {	return;	try {		if (social_loaded) {			FB.init({		          status: true,		          cookie: true,				xfbml: true			});			FB.XFBML.parse();			twttr.widgets.load();			return;		}	console.log(facebook_api);		$.ajax({		  url: facebook_api,		  dataType: "script",		  success: function() {			try {				FB.init({					xfbml: true				});				FB.XFBML.parse();			  	social_loaded = true;				} catch (err) {				}		  }		});		$.ajax({		  url: twitter_api,		  dataType: "script",		  success: function() {				try {					twttr.widgets.load();			  	social_loaded = true;				} catch (err) {				}		  }		});		} catch (err) {		}}function product_clicks() {	ajax_clicks();	$('.gift_cards button').unbind('click').on('click', function() {		var val = $('#gift_card').val();		if (val) {			$.ajax({				type: 'POST',				url: current_location+'/cart/add_gc/'+val			}).done(function(r) {				if (r) {					alert('Gift Card added to cart');					$('#minicart').html(r);					$('#head_mobile #minicart').html(r);					cart_clicks();				} else {					alert('Please, enter numeric value');				}			});		}	});	if ($(window).width() > 700)		$('#zoom').zoom();	load_social();	if (oid == 0) {		qadd = '';		product_base = $('.product');	} else {		qadd = '.product_popup ';		product_base = $('.product_popup');	}	if (oid == 0)		default_images = $(qadd+'.product .photo table').html();	else		default_images_ql = $(qadd+'.product .photo table').html();	postprocess();	var rating_clicked = false;	$('.rating').unbind('mouseleave').mouseleave(function() {		if (rating_clicked) {			$('.rating span.r'+$('#review_rating').val()).click();		} else			$('.rating').removeClass('r1').removeClass('r2').removeClass('r3').removeClass('r4').removeClass('r5');	});	$('.rating span').on('click', function() {		rating_clicked = true;		recalc_rating($(this));		$('#review_rating').val($(this).attr('class').replace('r', ''));	});	$('.rating span').unbind('mouseover').mouseover(function() {		recalc_rating($(this));	});	recaptchaOnload();}function recalc_rating(span) {		$('.rating').removeClass('r1').removeClass('r2').removeClass('r3').removeClass('r4').removeClass('r5');		if (span.hasClass('r1')) {			$('.rating').addClass('r1');		} else if (span.hasClass('r2')) {			$('.rating').addClass('r1').addClass('r2');		} else if (span.hasClass('r3')) {			$('.rating').addClass('r1').addClass('r2').addClass('r3');		} else if (span.hasClass('r4')) {			$('.rating').addClass('r1').addClass('r2').addClass('r3').addClass('r4');		} else if (span.hasClass('r5')) {			$('.rating').addClass('r1').addClass('r2').addClass('r3').addClass('r4').addClass('r5');		}}function postprocess(ql) {		var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;		$('[name=pricematch] input').on('keyup', function() {			if ($(this).parent().parent().find('.star').length > 0) {				if ($(this).val() != '' && $(this).parent().find('img.mark-green').length == 0 && ($(this).attr('name') != 'email' || emailReg.test($(this).val()))) {					$(this).parent().find('img.mark-red').remove();					$(this).removeClass('input-incorrect');					$(this).parent().append('<img src="'+$('.spacer-src').attr('src')+'" class="mark-green" alt="Field correct" />');					$(this).addClass('input-correct');				} else if ($(this).val() == '' || ($(this).attr('name') == 'email' && !emailReg.test($(this).val()))) {					$(this).parent().find('img.mark-green').remove();					$(this).removeClass('input-correct');				}			}		});		$('[name=crform] input, [name=crform] textarea').on('keyup', function() {			if ($(this).parent().parent().find('.star').length > 0) {				if ($(this).val() != '' && $(this).parent().find('img.mark-green').length == 0) {					$(this).parent().find('img.mark-red').remove();					$(this).removeClass('input-incorrect');					$(this).parent().append('<img src="'+$('.spacer-src').attr('src')+'" class="mark-green" alt="Field correct" />');					$(this).addClass('input-correct');				} else if ($(this).val() == '') {					$(this).parent().find('img.mark-green').remove();					$(this).removeClass('input-correct');				}			}		});		rate_clicked = 0;		$('div.gst-tab').unbind('click').on('click', function() {			$('div.gst-tab').removeClass('active');			$(this).addClass('active');			if ($(this).attr('id') == 'inc_gst') {				gst_applied = true;			} else {				gst_applied = false;			}			recalculate_gst();		});		// Save gallery list items		var o = this;		if ($(qadd+'#hasVariants').length > 0) {		}		$(qadd+'.price-breaks').mouseover(function() {			$(qadd+'.price-breaks div').show();		});		$(qadd+'.price-breaks').mouseout(function() {			$(qadd+'.price-breaks div').hide();		});		$(qadd+'[name=amount]').change(function() {			if ($(this).val() < 1)				$(this).val('1');			product_options(o);		}).on('keyup', function() {			product_options(o);		});		$('.clear_option').unbind('click').on('click', function() {			var groupid = $(this).attr('id').replace('poa-', '');			$('#pot-'+groupid).html('');			$('#pot-'+groupid).hide();			$('#poa-'+groupid).hide();			$('#pog-'+groupid+' img.checked').remove();			$('#po-'+groupid).val('');			map_variants(o);			product_options(o);			$(qadd+'.options-error').hide();		});		$(qadd+'.options_container div').unbind('click').on('click', function() {			if ($(this).hasClass('unavailable') || !($(this).hasClass('option-image') || $(this).hasClass('option-name')) || clear_clicked) {				clear_clicked = false;				return false;			}			$(this).parent().find('div img.checked').remove();			var val = '';			if ($(this).find('img').length > 0)				val = $(this).find('img').attr('alt');			else				val = $(this).html();			var groupid = $(this).parent().attr('id').replace('pog-', '');			$('#pot-'+groupid).html(': '+val);			$('#pot-'+groupid).show();			$('#poa-'+groupid).show();			$(this).append("<img src='"+current_location+"/images/check-mark.png' class='checked'>");			var optionid = $(this).attr('id').replace('poi-', '');			$('#po-'+groupid).val(optionid);			map_variants(o, groupid);			product_options(o);			$(qadd+'.options-error').hide();		});		$(qadd+'.product_options').unbind('change').change(function() {			var id = $(this).attr('id').replace('po-', '');			if ($(this).val()) {				$('#pot-'+id).html(': '+$(this).find('option:selected').text());				$('#pot-'+id).show();				$('#poa-'+id).show();			} else {				$('#pot-'+id).hide();				$('#poa-'+id).hide();			}			map_variants(o, id);			product_options(o);			$(qadd+'.options-error').hide();		});		product_options(o);		map_variants(o);		$('.add2cart').unbind('click').on('click', function() {			if (!option_selected())				return false;		});		// Form AJAX-based submit		$('form.product-details', product_base).eq(0).unbind('submit').on('submit',			function(event)			{				return o.addProductToCart(event, this);			}		);		// Cloud zoom		var cloud = $('.cloud-zoom', product_base);		if (cloud.length) {			this.zoomWidget = true;			if (core.getCommentedData(cloud, 'kZoom')) {				this.kZoom = core.getCommentedData(cloud, 'kZoom');			}			var imageWrapper = $(document.createElement('div')).addClass('wrapper');			cloud.wrap(imageWrapper);		}		if ($(qadd+'.product-image-gallery li a').length) {			// TODO: improve to skip additional JS manipulations			// like resizing etc when it is not needed			this.selectImage(0);		} else if (this.zoomWidget && !cloud.data('zoom')) {			cloud.CloudZoom();		}		// Change Continue shopping button for QuickLook mode		make_gallery_click_on_quick_look();		$('.ql-zoom', product_base).css('z-index', 10999);		// Gallery		if (typeof(window.lightBoxImagesDir) != 'undefined') {			$('.loupe', product_base).on('click',				function(event) {					o.showLightbox();					setTimeout(						function() {							$('.product-image-gallery li.selected a').eq(0).trigger('click');						},						500					);					return false;				}			);		}		// Tabs		$('.product-details-tabs .tabs div', product_base).on('click',			function () {				if (!$(this).hasClass('active')) {					var id = $(this).find('a').attr('id').substr(5);					$('.product-details-tabs .tabs div.active').removeClass('active');					$(this).addClass('active');					var box = $(this).parents('.product-details-tabs');					if (box.find('#' + id).hasClass('scroll-pane')) {						destroy_custom_scrolls_bars(box.find('#' + id));					}					destroy_custom_scrolls_bars(box.find('.variants-list'));					box.find('.tab-container').hide();					box.find('#' + id).show();					box.find('.faq-answer').eq(0).show();					if (box.find('#' + id).hasClass('scroll-pane')) {						if (box.find('#' + id).hasClass('Reviews-tab')) {							scroll_apis[scroll_apis.length] = [box.find('#' + id), box.find('#' + id).jScrollPane().data().jsp];						} else {							custom_scrolls_bars(box.find('#' + id));						}					}					custom_scrolls_bars(box.find('.variants-list'));					if ($('.cp_message .progress-bar').length > 0) {						$('.cp_message div').html('');						$('.cp_message_fade').hide();						$('.cp_message').hide();						$('.cp_message button').show();					}					if ($('.cr_message .progress-bar').length > 0) {						$('.cr_message div').html('');						$('.cr_message_fade').hide();						$('.cr_message').hide();						$('.cr_message button').show();					}				}				return true;			}		);	$('.add-review', product_base).on('click', function() {		if ($('.norelated').length > 0)			$('html, body').animate({scrollTop: $(".customerReviews h3").offset().top}, 2000);		else {			$('.Reviews-tab').data('jsp').scrollTo(0, $('.Reviews-tab .jspPane').height());			$(this).hide();		}	});	$('.Reviews-tab').on(		'jsp-scroll-y',		function(event, scrollPositionY) {			$('.add-review').show();			$('.add-review').css('top', scrollPositionY);		}	);	$('.faq-question', product_base).on('click',		function() {			var o = $(this);			$('.faq-answer').each(				function() {					if (o[0] != $(this).parents()[0])						$(this).slideUp();				}			);			$(this).find('.faq-answer').slideDown(				'',				function() {					custom_scrolls_bars($('.FAQ-tab'));				}			);		}	);		// Related Tabs		$('.related-items .tabs div', product_base).on('click',			function () {				if (!$(this).hasClass('active')) {					var id = $(this).attr('id').substr(5);					$('.related-items .tabs div.active').removeClass('active');					$(this).addClass('active');					var box = $(this).parents('.related-items');					box.find('.tab-container').hide();					box.find('#' + id).show();				}				return true;			}		);		// Bottom tabs		$('.product-details-bottom-tabs .tabs div', product_base).on('click',			function () {				if (!$(this).hasClass('active')) {					var id = $(this).find('a').attr('id').replace('link-bt-', '');					$('.product-details-bottom-tabs .tabs div.active').removeClass('active');					$(this).addClass('active');					var box = $(this).parents('.product-details-bottom-tabs');					if (box.find('.FAQ-tab').length > 0) {						destroy_custom_scrolls_bars($('.FAQ-tab'));						box.find('.tab-container').hide();						$('.FAQ-tab').show();						custom_scrolls_bars($('.FAQ-tab'));					} else {						destroy_custom_scrolls_bars(box.find('#tab-content-'+id+' .scroll-pane'));						box.find('.tab-container').hide();						box.find('#tab-content-'+id).show();						custom_scrolls_bars(box.find('#tab-content-'+id+' .scroll-pane'));					}				}				return true;			}		);		// Custom quantity		custom_quantity();		if (!product_base.hasClass('product-quicklook') && !(0 < product_base.parents('.blockUI').length)) {			$('#relatedItems .img img').on('click', function() {				popup.postprocessRequestCallback = function()				{					popup.postprocessRequest.apply(popup, arguments);					$(qadd+'.product-image-gallery a').eq(0).trigger('click');				};				return !popup.load(					URLHandler.buildURL({						target:			'quick_look',						action:			'',						productid:		$(this).parent().attr('id').replace('ip', ''),						only_center:	1					}),					'product-quicklook',					function () {						oid = 0;						qadd = '';						$('.formError').hide();					},					50000				);			});			$('.related-to-cart').on('click',				function()				{					if ($(this).hasClass('no-options')) {						var pid = $(this).attr('id').replace('p', '');						var data = 'target=cart&action=add&productid='+pid+'&amount='+$(this).parent().find('.value').html()+'&returnURL='+$(qadd+'[name=returnURL]').val();						var o2 = this;						$.ajax({							type: 'POST',							url: '/store/cart',							data: data,							beforeSend: function ( xhr ) {								$(o2).parent().find('.cquantity').hide();								$(o2).parent().find('img').hide();								if ($(o2).parent().find('.progress-bar').length > 0) {									$(o2).parent().find('.progress-bar').show();								} else {									$(o2).parent().append('<div class="progress-bar"><div class="block-wait"><div></div></div></div>');								}							}						}).done(function(data) {							$('#status-messages ul').html('<li style="" class="status">Product has been added to cart</li>');							$('#status-messages').slideDown(50);							setTimeout(function() {$('#status-messages').slideUp(500);$('#status-messages ul').html('<li class="dump">Dump</li>');}, 10000);							$.ajax({								type: 'GET',								url: '?productid='+pid+'&q=store/main/?productid='+pid+'/widget-XLite\\Module\\XCDev\\Medshop\\View\\GetAvail',								data: data							}).done(function(data) {								core.trigger('updatecart', eval('({"items":[]})'));								if (data != 'N') {									var qty = data.split('|')[0];									if (qty == 0) {										$(o2).parent().find('.cquantity').remove();										$(o2).parent().append('<div class="ofs">Out of stock</div>');									} else										$(o2).parent().find('.values').html(qty);								}								custom_quantity();								$(o2).parent().find('.progress-bar').hide();								$(o2).parent().find('.cquantity').show();								if (!(data != 'N' && qty == 0))									$(o2).parent().find('img').show();							});						});					} else {						popup.postprocessRequestCallback = function()						{							popup.postprocessRequest.apply(popup, arguments);							$(qadd+'.product-image-gallery a').eq(0).trigger('click');						};						return !popup.load(							URLHandler.buildURL({								target:			'quick_look',								action:			'',								amount:		 $(this).parent().find('.value').html(),								productid:	$(this).attr('id').replace('p', ''),								only_center: 1							}),							'product-quicklook',							function () {								oid = 0;								qadd = '';								$('.formError').hide();							},							50000						);					}				}			)		}		$('.customerReviews .rate img', product_base).unbind('mouseover').mouseover(function() {			$('.customerReviews .rate img', product_base).removeClass('hover');			var id = $(this).attr('id').replace('star-', '');			for (var i = 0; i < 5; i++) {				if (i <= id) {					$('#star-'+i).addClass('hover');				}  			}		}).unbind('click').on('click', function() {			$('.customerReviews .rate img', product_base).removeClass('hover');  			var id = parseInt($(this).attr('id').replace('star-', ''));  			rate_clicked = id+1;  			for (var i = 0; i < 5; i++) {	  			if (i <= id) {	  				$('#star-'+i).addClass('hover');	  			}  			}		});		$('.customerReviews .rate', product_base).unbind('mouseout').mouseout(function() {			$('.customerReviews .rate img', product_base).removeClass('hover');			if (rate_clicked > 0) {	  			for (var i = 0; i < 5; i++) {	  				if (i <= rate_clicked-1) {	  					$('#star-'+i).addClass('hover');		  			}	  			}			}		});		$('.r-show-more').mouseover(function() {			$('.r-over').show();		});		$('.r-show-more').mouseout(function() {			$('.r-over').hide();		});		$('.otfilter select').unbind('change').change(function() {			var found = false;			$('.otfilter select').each(function() {				if ($(this).val()) {					found = true;				}			});			if (found) {				$('.otfilter .submit').addClass('active');			}		});		$(qadd+'.otfilter .submit').on('click', function() {			filter_variants(1);			$('.otfilter .submit').removeClass('active');		});		$('.otfilter .reset').unbind('click').on('click', function() {			if ($(this).hasClass('active')) {				for (var i = 0; i < document.otfilter.elements.length; i++)					document.otfilter.elements[i].value='';				filter_variants(2);				$(this).removeClass('active');				$('.otfilter .submit').removeClass('active');			}		});		$('.sorting li').unbind('click').on('click', function() {			if ($(this).attr('id') && !$(this).hasClass('active')) {				$(qadd+'.sorting li').removeClass('active');				$(this).addClass('active');				filter_variants(0,$(this).attr('id'));			}		});        variantsClicks();		$('.getquote').on('click', function(){			if (!option_selected())				return false;			var options = '';			$(qadd+'.product-option textarea').each(function(){				var name = $(this).attr('name').replace('product_options[', '');				name = name.replace(']', '');				options += name+'(|,|)'+encodeURIComponent($(this).val())+'(|;|)';			});			$(qadd+'.product-option input').each(function(){				var name = $(this).attr('name').replace('product_options[', '');				name = name.replace(']', '');				options += name+'(|,|)'+encodeURIComponent($(this).val())+'(|;|)';			});			$(qadd+'.product-option select').each(function(){				var name = $(this).attr('name').replace('product_options[', '');				name = name.replace(']', '');				options += name+'(|,|)'+encodeURIComponent($(this).val())+'(|;|)';			});			popup.load(				URLHandler.buildURL({					target:			'get_quote',					action:			'',					productid:		$(this).attr('id').replace('gq', ''),					only_center:	1,					product_options:options,					amount:			$(qadd+'[name=amount]').val()				}),				'get-quote',				function () {					oid = 0;					qadd = '';					$('.formError').hide();				},				50000			);		});		if (self.location.hash) {			$('.product-details-tabs .tabs li a#link-' + self.location.hash.substr(1), product_base).click();		}}$('body').on('click',	function() {		if (!qty_clicked)			$('.cquantity .values').hide();		qty_clicked = false;		if (!image_popup_clicked)			$('.image_popup').hide();		image_popup_clicked = false;	});$(function() {	if ($('.related-delim .related-items').length == 1 && $('.related-delim .related-exist .product-details-bottom-tabs').length == 0) {		$('.product-details-tabs .tab-container').height(427);	}});function make_gallery_click_on_quick_look() {	$('.product-quicklook .gallery_left, .product-quicklook .vgallery_left').unbind('click').on('click', function() {		var visible_id = 0;		var previous_id = 0;		var prev_id = 0;		if ($(this).hasClass('vgallery_left')) {			$('.product-quicklook .variants-gallery ul').each(function() {				var id = $(this).attr('id').substring(9, 10);				if (!$(this).hasClass('inactive')) {					visible_id = id;					previous_id = prev_id;				}				prev_id = id;			});			$('.product-quicklook .variants-gallery ul').addClass('inactive');			if (previous_id == 0 && visible_id == 0)				$('#vgallery_'+prev_id+'_quick_look').removeClass('inactive');			else				$('#vgallery_'+previous_id+'_quick_look').removeClass('inactive');		} else {			$('.product-quicklook .product-image-gallery ul.dgallery').each(function() {				var id = $(this).attr('id').substring(8, 9);				if (!$(this).hasClass('inactive')) {					visible_id = id;					previous_id = prev_id;				}				prev_id = id;			});			$('.product-quicklook .product-image-gallery ul').addClass('inactive');			if (previous_id == 0 && visible_id == 0)				$('#gallery_'+prev_id+'_quick_look').removeClass('inactive');			else				$('#gallery_'+previous_id+'_quick_look').removeClass('inactive');		}	});	$('.product-quicklook .gallery_right, .product-quicklook .vgallery_right').unbind('click').on('click', function() {		var visible_id = 0;		if ($(this).hasClass('vgallery_right')) {			var visible_id = 0;			$('.product-quicklook .variants-gallery ul').each(function() {				var id = $(this).attr('id').substring(9, 10);				if (!$(this).hasClass('inactive')) {					visible_id = id;				}			});			$('.product-quicklook .variants-gallery ul').addClass('inactive');			var defined = false;			$('.product-quicklook .variants-gallery ul').each(function() {				var id = $(this).attr('id').substring(9, 10);				if (id > visible_id && !defined) {					$(this).removeClass('inactive');					defined = true;				}			});			if (!defined) {				$('#vgallery_0_quick_look').removeClass('inactive');			}		} else {			$('.product-quicklook .product-image-gallery ul.dgallery').each(function() {				var id = $(this).attr('id').substring(8, 9);				if (!$(this).hasClass('inactive')) {					visible_id = id;				}			});			$('.product-quicklook .product-image-gallery ul').addClass('inactive');			var defined = false;			$('.product-quicklook .product-image-gallery ul.dgallery').each(function() {				var id = $(this).attr('id').substring(8, 9);				if (id > visible_id && !defined) {					$(this).removeClass('inactive');					defined = true;				}			});			if (!defined) {				$('#gallery_0_quick_look').removeClass('inactive');			}		}	});}function product_options(o) {	if (oid == 1) {		var price = product_price_ql,			weight = product_weight_ql;	} else {		var price = product_price,			weight = product_weight;	}	var variantid = 0;	if ($(qadd+'#hasVariants').length > 0) {		$(qadd+'.add2cart').addClass('add2cartN');		var tmp = getVariantId(),			idx = tmp[1];		variantid = tmp[0];			if (variantid > 0 && variants[oid][idx][5].length > 0) {				var html = '';				for (var x in variants[oid][idx][5]) {					if (x == 0 || x == 4 || x == 9)						html += '<tr>';					html += '<td>'+variants[oid][idx][5][x]+'</td>';					if (x == 3 || x == 7)						html += '</tr>';				}				html += '</tr>';				$(qadd+'.product .photo table').html(html);				switch_photo($(qadd+'.product .photo table a:first'));			} else if ($(qadd+'.variants-gallery').hasClass('isvisible')) {				$(qadd+'.product-image-gallery').show();				$(qadd+'.variants-gallery').hide();				if ($(qadd+'.ql-zoom').length == 0) {					var next = $('#gallery_0');				} else {					var next = $('#gallery_0_quick_look');				}			} else {				if (oid == 0)					$(qadd+'.product .photo table').html(default_images);				else					$(qadd+'.product .photo table').html(default_images_ql);			}		if (variantid > 0) {			$(qadd+'.add2cart').removeClass('add2cartN');			if (variants[oid][idx][8])				$(qadd+'.fn.title').html(variants[oid][idx][8]);			else				$(qadd+'.fn.title').html($(qadd+'.fntitle').html());			$(qadd+'.product-sku').html(variants[oid][idx][0]);			if (variants[oid][idx][2]) {				$(qadd+'.product-weight').html(price_format(variants[oid][idx][2])+' <span class="weight-symbol">'+weight_symbol+'</span>');				$(qadd+'.product-weight').closest('tr').removeClass('hidden');			}			$(qadd+'.variants-data').show();			var html = '';			for (var x in groups[oid]) {				if (groups[oid][x][1]) {					if (options[oid][$('#po-'+groups[oid][x][0]).val()]) {						html += '<td nowrap><a href="javascript: void(0);" class="clearOption" id="co-'+groups[oid][x][0]+'">(x)</a> '+options[oid][$('#po-'+groups[oid][x][0]).val()]+'</td>';					}				}			}			html += '<td nowrap><a href="javascript: void(0);" class="clearAll">{lng[Clear all]}</a></td>';			$(qadd+'.variants-data table').html(html);			$('.clearOption').unbind('click').on('click', function() {				var groupid = $(this).attr('id').replace('co-', '');				$('#pot-'+groupid).html('');				$('#pot-'+groupid).hide();				$('#poa-'+groupid).hide();				$('#pog-'+groupid+' img.checked').remove();				$('#po-'+groupid).val('');				map_variants(o);				product_options(o);			});			$('.clearAll').unbind('click').on('click', function() {				for (var x in groups[oid]) {					var groupid = groups[oid][x][0];					$('#pot-'+groupid).html('');					$('#pot-'+groupid).hide();					$('#poa-'+groupid).hide();					$('#pog-'+groupid+' img.checked').remove();					$('#po-'+groupid).val('');				}				map_variants(o);				product_options(o);			});			price = variants[oid][idx][1];			var old_price = price;			if (variants[oid][idx][7].length > 0) {				var item_amount = $(qadd+'[name=amount]').val();				var hv = [];				var i = 0;				for (var x in variants[oid][idx][7]) {					if (variants[oid][idx][7][x][0] <= item_amount) {						price = variants[oid][idx][7][x][1];					}					hv[i] = variants[oid][idx][7][x];					i++;				}				var html = "<tr><th class='left'>{lng[Quantity]}</th><th>{lng[Price Per Unit]}</th></tr>";				html += '<tr><th class="td left">1-'+hv[0][0]+'</th><th class="td default" id="whpr-'+price_format(old_price)+'">$'+price_format(old_price)+'</th></tr>';				for (var x in hv) {					if (x == hv.length-1) {						html += '<tr><th class="td left">'+hv[x][0]+'+</th><th class="td right" id="whpr-'+hv[x][1]+'">$'+price_format(hv[x][1])+'</th></tr>';					} else {						html += '<tr><th class="td left">'+hv[x][0]+'-'+hv[parseInt(x)+1][0]+'</th><th class="td right" id="whpr-'+hv[x][1]+'">$'+price_format(hv[x][1])+'</th></tr>';					}				}				$(qadd+'.price-breaks div table').html(html);				$(qadd+'table.product-qty').addClass('with-p-b');				$(qadd+'.price-breaks').show();				$(qadd+'.price-breaks div').show();				$(qadd+'.price-breaks div').height($(qadd+'.price-breaks div table').height());				$(qadd+'.price-breaks div').hide();			} else {				$(qadd+'.price-breaks').hide();				$(qadd+'table.product-qty').removeClass('with-p-b');			}			var tmp = $(qadd+'.quantity-box-container input').attr('class').split(" ");			var classes = '';			for (var x in tmp) {				if (tmp[x].indexOf('validate[') > -1) {					classes += "min[1],max["+variants[oid][idx][3].toString()+"]] ";				} else {					classes += tmp[x]+' ';				}			}			if ($(qadd+'.quantity-box-container input').val() > variants[oid][idx][3]) {				$(qadd+'.quantity-box-container input').val(variants[oid][idx][3]);			}			$(qadd+'.quantity-box-container input').attr('class', classes);			if (variants[oid][idx][3].toString() == '0') {				console.log(idx);				$(qadd+'.add2cart').addClass('add2cartN');				$(qadd+'#quantity').hide();				$(qadd+'.price-breaks').hide();				$(qadd+'#out_of_stock').show();			} else {				$(qadd+'#out_of_stock').hide();				$(qadd+'#quantity').show();				if ($(qadd+'#quantity input').val() < 1)					$(qadd+'#quantity input').val('1');			}			$(qadd+'.options_container').each(function() {				if ($(this).find('img.checked').length == 0) {					var gid = $(this).attr('id').replace('pog-', '');					$(qadd+'#pot-'+gid).html(' <b class="optional">(Optional)</b>');					$(qadd+'#pot-'+gid).show();				}			});		} else {			if ($(qadd+'.fntitle').length > 0)				$(qadd+'.fn.title').html($(qadd+'.fntitle').html());			var cnt = 0,				cnt2 = 0;			$(qadd+'.options_container, '+qadd+'.product-option select').each(function() {				if (!$(this).hasClass('novar')) {					cnt2++;					if ($(this).get(0).tagName == 'DIV') {						if ($('#po-'+$(this).attr('id').replace('pog-', '')).val())							cnt++;					} else if ($(this).val())						cnt++;				}			});			if (cnt == cnt2) {				$('[name="options_ex"]').val(1);				bc = false;				alert("{lng[This options combination is not available]}");			} else {				$('[name="options_ex"]').val(0);			}			$(qadd+'.variants-data').hide();			$(qadd+'.price-breaks').hide();			$(qadd+'table.product-qty').removeClass('with-p-b');		}	} else if (w_prices[oid] && w_prices[oid].length > 0) {		var item_amount = $(qadd+'[name=amount]').val();		var hv = [];		var i = 0;		var old_price = price;		for (var x in w_prices[oid]) {			if (w_prices[oid][x][0] <= item_amount) {				price = w_prices[oid][x][1];			}			hv[i] = w_prices[oid][x];			i++;		}		var html = "<tr><th class='left'>{lng[Quantity]}</th><th>{lng[Price Per Unit]}</th></tr>";		html += '<tr><th class="td left">1-'+hv[0][0]+'</th><th class="td default" id="whpr-'+price_format(old_price)+'">$'+price_format(old_price)+'</th></tr>';		for (var x in hv) {			if (x == hv.length-1) {				html += '<tr><th class="td left">'+hv[x][0]+'+</th><th class="td right" id="whpr-'+hv[x][1]+'">$'+price_format(hv[x][1])+'</th></tr>';			} else {				html += '<tr><th class="td left">'+hv[x][0]+'-'+hv[parseInt(x)+1][0]+'</th><th class="td right" id="whpr-'+hv[x][1]+'">$'+price_format(hv[x][1])+'</th></tr>';			}		}		$(qadd+'.price-breaks div table').html(html);		$(qadd+'table.product-qty').addClass('with-p-b');		$(qadd+'.price-breaks').show();		$(qadd+'.price-breaks div').show();		$(qadd+'.price-breaks div').height($(qadd+'.price-breaks div table').height());		$(qadd+'.price-breaks div').hide();	}	if (exceptions[oid] && exceptions[oid].length > 0) {		var ex = exceptions[oid],			ex_ok = true;		for (var x in ex) {			var found = true;			for (var c in ex[x]) {				var value = $('#po-'+c).val();				if (!value) {					ex_ok = true;					found = false;					break;				}				if (value != ex[x][c]) {					found = false;					break;				}			}			if (found) {				ex_ok = false;				break;			}		}    	if (!ex_ok) {			$('[name="options_ex"]').val(1);			bc = false;			alert("{lng[This options combination is not available]}");		} else			$('[name="options_ex"]').val(0);	}	if ($(qadd+'.quantity-box-container input').val() > product_avail[oid]) {		$(qadd+'.quantity-box-container input').val(product_avail[oid]);	}	if (!variantid && $(qadd+'.product-options').length > 0) {		var price_modifier = 0,			weight_modifier = 0;		for (var x in groups[oid]) {			for (var y in groups[oid][x][3]) {				if ($(qadd+'#po-'+x).val() == y) {					if (groups[oid][x][3][y]) {						var modifier = groups[oid][x][3][y];						if (modifier[1] == '%') {							price_modifier += parseFloat(price) * parseFloat(modifier[0]) / 100;						} else {							price_modifier += parseFloat(modifier[0]);						}						if (modifier[3] == '%') {							weight_modifier += parseFloat(weight) * parseFloat(modifier[2]) / 100;						} else {							weight_modifier += parseFloat(modifier[2]);						}					}				}			}		}		$(qadd+'[name=nongstprice]').val(parseFloat(price)+parseFloat(price_modifier));		$('.price-breaks table th').each(function() {			if ($(this).hasClass('right')) {				var pr = parseFloat($(this).attr('id').replace('whpr-', ''));				if (pr > 0) {					if ($(this).hasClass('default')) {						$(this).html('$'+price_format(old_price+parseFloat(price_modifier)));						$(this).attr('id', 'whpr-'+price_format(old_price+parseFloat(price_modifier)));					} else {						$(this).html('$'+price_format(pr+parseFloat(price_modifier)));						$(this).attr('id', 'whpr-'+price_format(pr+parseFloat(price_modifier)));					}				}			}		});		$(qadd+'.product-to-cart .product-details-price').html('<span class="currency">'+currency_symbol+'</span>'+price_format(parseFloat(price)+parseFloat(price_modifier)));		weight = parseFloat(weight)+parseFloat(weight_modifier);		$(qadd+'.product-weight').html(price_format(weight)+' <span class="weight-symbol">'+weight_symbol+'</span>');	} else {		$(qadd+'.product-to-cart .product-details-price').html('<span class="currency">'+currency_symbol+'</span>'+price_format(parseFloat(price)));	}	if (oid == 0) {		recalculate_gst();	}}function getVariantId(r) {	var variantid = 0;	var idx = 0;	for (var x in variants[oid]) {		var c = 0;		for (var y in variants[oid][x][4])			c++;		var c2 = $(qadd+'.options_container div img.checked').length;		$(qadd+'.product_options').each(function(){			if ($(this).val() > 0 && !$(this).hasClass('novar'))				c2++;		});		if (c == c2) {			variantid = variants[oid][x][6];			idx = x;			for (var y in variants[oid][x][4])				if ($(qadd+'#po-'+y).val() != variants[oid][x][4][y]) {					variantid = false;					break;				}			if (variantid)				break;		}	}	return [variantid, idx];}function map_variants(o, groupid) {	var ids = [],		vids = [],		cnt = 0;	$(qadd+'.options_container, '+qadd+'.product-option select').each(function() {		if (!$(this).hasClass('novar'))			cnt++;	});	if (cnt > 1) {		var ids = [];		$(qadd+'.options_container, '+qadd+'.product-option select').each(function() {			if (!$(this).hasClass('novar')) {				var gid = $(this).attr('id').replace('pog-', '');				if ($(this).get(0).tagName == 'DIV') {					ids[gid] = $('#po-'+gid).val();				} else {					ids[$(this).attr('id').replace('po-', '')] = $(this).val();				}			}		});		var vids = [];		for (var x in variants[oid]) {			var found = true;			for (var y in variants[oid][x][4]) {				if (ids[y] > 0) {					var found2 = false;					for (var z in ids) {						if (z == y && ids[z] == variants[oid][x][4][y]) {							found2 = true;							break;						}					}					if (!found2) {						found = false;						break;					}				}			}			if (found) {				vids[x] = 1;			}		}		var ids = [];		for (var x in vids) {			for (var y in variants[oid][x][4]) {				if (!ids[y]) {					ids[y] = [];				}				ids[y][variants[oid][x][4][y]] = 1;			}		}		var ids2 = [];		for (var x in ids) {			for (var y in ids[x]) {				ids2[y] = 1;			}		}		remove_options(groupid, ids2);	}	$('.help-option').remove();	$(qadd+'.unavailable').each(function() {		if (!$(this).parent().hasClass('novar')) {			var html = '<table>',				id = $(this).parent().attr('id'),				found = false;			$(qadd+'.options_container img.checked').each(function() {				if (id != $(this).parent().parent().attr('id')) {					html += '<tr><td>'+$(this).parent().attr('data-title')+'</td><td class="clear"><a href="javascript: void(0);" class="clear-option" id="co-'+$(this).parent().parent().attr('id').replace('pog-', '')+'">{lng[Clear]}</a></td></tr>';					found = true;				}			});			$(qadd+'.product_options').each(function() {				if (id != $(this).attr('id').replace('po-', '')) {					html += '<tr><td>'+$(this).find('option:selected').text()+'</td><td class="clear"><a href="javascript: void(0);" class="clear-option" id="co-'+$(this).attr('id').replace('po-', '')+'">{lng[Clear]}</a></td></tr>';					found = true;				}			});		}		html += '</table>';		if (found)			$(this).append("<div class='help-option'>{lng[Option Not Available in Combination with]}"+html+'<img src="'+current_location+'/images/spacer.gif" alt="" /></div>');		else			$(this).append("<div class='help-option'>{lng[Option Not Available]}<img src='"+current_location+"/images/spacer.gif' alt='' /></div>");	});	$('.clear-option').unbind('click').on('click', function() {		$(this).parent().parent().parent().parent().parent().parent().find('.help-option').remove();		var groupid = $(this).attr('id').split('-')[1];		$('#pot-'+groupid).html('');		$('#pot-'+groupid).hide();		$('#poa-'+groupid).hide();		$('#pog-'+groupid+' img.checked').remove();		$('#po-'+groupid).val('');		map_variants(o, groupid);		product_options(o);		clear_clicked = true;	});}function remove_options(groupid, ids) {	$(qadd+'.options_container div').each(function() {		if (!$(this).parent().hasClass('novar') && !$(this).hasClass('clear') && !$(this).hasClass('help-option')) {			var gid = $(this).parent().attr('id').replace('pog-', '');			if (gid != groupid) {				var optid = $(this).attr('id').replace('poi-', '');				if (ids[optid] == 1) {					$(this).removeClass('unavailable');				} else {					$(this).addClass('unavailable');					if ($(this).find('img.checked').size > 0) {						$(this).find('img.checked').remove();						$(qadd+'#pot-'+groupid).html('');						$(qadd+'#pot-'+groupid).hide();						$(qadd+'#poa-'+groupid).hide();						$(qadd+'#po-'+groupid).val('');					}				}			}		}	});	$(qadd+'.product-option select').each(function() {		var gid = $(this).attr('id').replace('po-', '');		if (!$(this).hasClass('novar') && gid != groupid) {			for (var x = 0; x < $(this).find('option').length; x++) {				var opt = $(this).find('option:eq('+x+')');				var optid = opt.val();				if (!optid || ids[optid] == 1) {					opt.removeClass('unallowed');					opt.attr('disabled', false);				} else {					opt.addClass('unallowed');					opt.attr('disabled', true);				}			}		}	});}function recalculate_gst() {	var price = $('[name=nongstprice]').val();	if (price) {		if (gst_applied) {			$('.product-to-cart h3').html('$' + price_format(price * 1.1));			$('.price-breaks table th').each(function() {				if ($(this).hasClass('td')) {					var pr = parseFloat($(this).attr('id').replace('whpr-', ''));					if (pr > 0) {						$(this).html('$'+price_format(pr * 1.1));					}				}			});		} else {			$('.product-to-cart h3').html('$' + price_format(price));		}	}}function custom_quantity() {	var cq_zindexes = parseInt($(qadd+'.cquantity').length) + 5;	$(qadd+'.cquantity').each(		function() {			var max = parseInt($(this).find('.values').html());			if (!IsNumeric(max))				return true;			if (max == 0) {				$(this).find('.value').html('0');				$(this).parent().find('.related-to-cart').hide();			} else {				var current = parseInt($(this).find('.value').html());				if (max > 50)					max = 50;				var html = '<ul>';				for (var i = 1; i <= max; i++) {					html += '<li'+(i == current?' class="selected"':'')+'>'+i+'</li>';				}				html += '</ul>';				$(this).find('.values').html(html);				$(this).css('z-index', cq_zindexes);				cq_zindexes--;			}		}	).unbind('click').on('click',		function() {			if ($(this).hasClass('sbclicked')) {				$(this).removeClass('sbclicked');			} else {				qty_clicked = true;				var was_visible = false;	 			if ($(this).find('.values').is(':visible')) {	 				$(this).find('.values').hide();	 				was_visible = true;		 		}				$('.cquantity .values').hide();				if (!was_visible && !$(this).hasClass('clicked')) {					destroy_custom_scrolls_bars($(this).find('.values'));					$('.cquantity .values').hide();					$(this).find('.values').show();					custom_scrolls_bars($(this).find('.values'));					$(this).find('.jspVerticalBar').on('click', function() {						qty_clicked = true;						$(this).parent().parent().parent().addClass('sbclicked');					});					$(this).find('.values li').unbind('click').on('click',						function() {							$('.values li').removeClass('selected');							$(this).addClass('selected');							$(this).parent().parent().parent().parent().parent().find('.value').html($(this).html());							$(this).parent().parent().parent().parent().hide();							$('.cquantity').removeClass('clicked');							$(this).parent().parent().parent().parent().parent().addClass('clicked');						}					);				}				$('.cquantity').removeClass('clicked');   			}		}	);}function filter_variants(f,sort) {	var data = '';	for (var i = 0; i < document.otfilter.elements.length; i++)		if (document.otfilter.elements[i].name != '' && document.otfilter.elements[i].value != '')			data += document.otfilter.elements[i].name+'='+cp_escape(document.otfilter.elements[i].value)+'&';	if (f == 1) {		if (data && $('.otfilter .submit').hasClass('active'))			$('.otfilter .reset').addClass('active');		else			return false;	}	$.ajax({		type: 'GET',		url: '?productid='+$('form.product-details', product_base).get(0).elements.namedItem('productid').value+'&'+data+'sort='+sort+'&q=store/main/?/widget-XLite\\Module\\XCDev\\Medshop\\View\\OptionsTableFilter',		beforeSend: function ( xhr ) {			if ($('.variants-list').width() < 800)				$('.Table-tab .progress-bar').css('left', '241px');			else				$('.Table-tab .progress-bar').css('left', '500px');			$('.Table-tab .progress-bar').show();			$('.variants-list').addClass('variants-loading');		}	}).done(function(data) {		$('.variants-list').hide();		$('.Table-tab .progress-bar').hide();		$('.variants-list').removeClass('variants-loading');		destroy_custom_scrolls_bars($('.variants-list'));		$('.variants-list').html(data);		$('.variants-list').html($('.variants-list .ajax-container-loadable').html());		$('.variants-list').show();		custom_scrolls_bars($('.variants-list'));		variantsClicks();		custom_quantity();	});}function variantsClicks() {	$('.sku img').unbind('click').on('click', function() {		$('.otfilter .image_popup .img').remove();		$('.otfilter .image_popup').append('<div class="img">'+$(this).parent().find('.image').html()+'</div>');		$('.otfilter .image_popup').show();		image_popup_clicked = true;	});	$('.otfilter .image_popup .close').unbind('click').on('click', function() {		$('.otfilter .image_popup').hide();	});	$('.otfilter .image_popup').unbind('click').on('click', function() {		image_popup_clicked = true;	});	$('.v2cart, .wp img').unbind('click').on('click', function() {		if ($(this).hasClass('v2cart')) {			var amount = 1;			var vid = $(this).parent().attr('id').replace('v-', '');		} else {			var amount = $(this).parent().find('.value').html();			var vid = $(this).parent().parent().attr('id').replace('v-', '');		}		var pid = $('.product-details [name=productid]').val();		var data = 'target=cart&action=add&productid='+pid+'&variantid='+vid+'&amount='+amount+'&returnURL='+$(qadd+'[name=returnURL]').val();		var o2 = this;		$.ajax({			type: 'POST',			url: '/store/cart',			data: data,			beforeSend: function ( xhr ) {				if ($(o2).hasClass('v2cart')) {					$(o2).parent().append('<img src="'+$('.spacer-src').attr('src')+'" class="loading" alt="Please, wait." />');					$(o2).hide();					$(o2).parent().find('.wp').addClass('wphidden');				} else {					$(o2).parent().parent().append('<img src="'+$('.spacer-src').attr('src')+'" class="loading" alt="Please, wait." />');					$(o2).parent().parent().find('.v2cart').hide();					$(o2).parent().addClass('wphidden');				}			}		}).done(function(data) {			$('#status-messages ul').html('<li style="" class="status">Product has been added to cart</li>');			$('#status-messages').slideDown(50);			setTimeout(function() {$('#status-messages').slideUp(500);$('#status-messages ul').html('<li class="dump">Dump</li>');}, 10000);			$.ajax({				type: 'GET',				url: '?productid='+pid+'&variantid='+vid+'&q=store/main/?productid='+pid+'/widget-XLite\\Module\\XCDev\\Medshop\\View\\GetAvail',				data: data			}).done(function(data) {				core.trigger('updatecart', eval('({"items":[]})'));				var qty = -1;				if (data != 'N') {					qty = data.split('|')[0];					$(o2).parent().find('.values').html(qty);				}				if (qty == 0) {					if ($(o2).hasClass('v2cart')) {						$(o2).parent().parent().addClass('ofs');						$(o2).parent().parent().html('Out Of Stock');					} else {						$(o2).parent().parent().parent().addClass('ofs');						$(o2).parent().parent().parent().html('Out Of Stock');					}				} else {					custom_quantity();					if ($(o2).hasClass('v2cart')) {						$(o2).parent().find('.loading').remove();						$(o2).parent().find('.wp').removeClass('wphidden');						$(o2).show();					} else {						$(o2).parent().parent().find('.loading').remove();						$(o2).parent().parent().find('.v2cart').show();						$(o2).parent().removeClass('wphidden');					}				}			});		});	});}function option_selected() {	if ($(qadd+'#hasVariants').length > 0) {		if ($(qadd+' input.quantity').val() == 0)			return false;		else {			var tmp = getVariantId();			var variantid = tmp[0];			if (!(variantid > 0)) {				$(qadd+'.options-error').show();				setTimeout('hideOptionsError()', 1000);				return false;			}		}	} else {		for (var x in groups[oid]) {			if (!$(qadd+'#po-'+x).get(0)) {				continue;			}			if (!($(qadd+'#po-'+x).val() > 0)) {				$(qadd+'.options-error').show();				setTimeout('hideOptionsError()', 1000);				return false;			}		}	}	return true;}function validate_gq() {	if (!document.gqform.name.value) {		document.gqform.name.focus();		$('[name=gqform] [name=name]').addClass('input-incorrect');		return false;	}	var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;	if (!document.gqform.email.value || !emailReg.test(document.gqform.email.value)) {		document.gqform.email.focus();		$('[name=gqform] [name=email]').addClass('input-incorrect');		return false;	}	var data = '&';	for (var i = 0; i < document.gqform.elements.length; i++) {		if (document.gqform.elements[i].name != '')			data += document.gqform.elements[i].name+'='+cp_escape(document.gqform.elements[i].value)+'&';	}	$.ajax({		type: 'GET',		url: '?q=store/main/?'+data+'/widget-XLite\\Module\\XCDev\\Medshop\\View\\GetQuote',		beforeSend: function (xhr) {			$('[name=gqform]').html('<div class="progress-bar"><div class="block-wait"><div></div></div></div>');		}	}).done(function(data) {		$('[name=gqform]').html('<h2>Thank you. We will get back soon.</h2>');	});	return false;}function add_to_cart(productid, is_quick) {	aload();	$('.product_popup').css('opacity', 1).css('transform', 'matrix(1.1, 0, 0, 1.1, 0, 70)');	setTimeout(function() {		$('.product_popup').css('transform', 'matrix(1, 0, 0, 1, 0, 0)');		setTimeout(function() {			$('.product_popup').remove();		}, 200);	}, 200);	if (!mobile_design)		$('body').append('<div class="popup no_animation cart_popup hidden"></div>');	$.ajax({		url: current_location+'/cart/add',		type: 'POST',		data: (is_quick == 'Y' ? "productid="+productid+"&amount=1" : $(qadd+'form[name="product-details"]').serialize())	}).done(function(r) {		unload();		if (r == "1") {			alert("{lng[Please, select options]}");			return false;		}		if (mobile_design) {			alert("{lng[Product has been added to your cart.]}<br /><br /><a href='/cart'><button>{lng[View cart]}</button></a> &nbsp; <a href='/checkout'><button>{lng[Checkout]}</button></a>", 1);		}		var result = r.toString().split(ajax_delimiter);		$('.cart_popup').html('<span class="close close-popup">x</span>'+result['1']);		$('#minicart').html(result['0']);		$('#head_mobile #minicart').html(result['0']);		unload();		fade();		var top = ($(window).scrollTop() + $(window).height() / 2 - $('.cart_popup').height() / 2) - 50;		if (top < $(window).scrollTop())			top = $(window).scrollTop() + 30;		$('.cart_popup').css('top', top + 'px');		$('.cart_popup').css('opacity', 0).css('left', ($(window).width() / 2 - $('.cart_popup').width() / 2 - 20) + 'px');		$('.cart_popup').removeClass('no_animation');		$('.cart_popup').css('opacity', 0).css('transform', 'matrix(1, 0, 0, 1, 0, 0)');		setTimeout(function() {			$('.cart_popup').css('opacity', 1).css('transform', 'matrix(1.1, 0, 0, 1.1, 0, 70)');			setTimeout(function() {				$('.cart_popup').css('transform', 'matrix(1, 0, 0, 1, 0, 0)');			}, 200);		}, 200);		$('.cart_popup').removeClass('hidden');		$(window).resize(function() {			var top = ($(window).scrollTop() + $(window).height() / 2 - $('.cart_popup').height() / 2) - 50;			if (top < $(window).scrollTop())					top = $(window).scrollTop() + 30;			$('.cart_popup').css('top', top + 'px');			$('.cart_popup').css('left', ($(window).width() / 2 - $('.cart_popup').width() / 2 - 20) + 'px');		});		$('.cart_popup .close, .cart_popup .close_popup').on('click', function() {			$('.fade').click();			return;    		var e = $('.cart_popup');	    	e.slideUp();	    	unfade();			setTimeout(function(){e.remove()}, 500);		});		$('.cart_popup').on('click', function() {			bc = false;			bb = true;		});		cart_clicks();	});	return false;}function check_exceptions() {  for (var x in exceptions) {    if (!hasOwnProperty(exceptions, x) || isNaN(x))      continue;    var found = true;    for (var c in exceptions[x]) {      if (!hasOwnProperty(exceptions[x], c))        continue;      var value = getPOValue(c);      if (!value)        return true;      if (value != exceptions[x][c]) {        found = false;        break;      }    }    if (found)      return false;  }  return true;}function switch_photo(a) {	if (mobile_design) {		$('#zoom-mobile').html('<img src="'+a.attr('href')+'">');	} else if ($('.product_popup').is(':visible')) {		$('.product_popup #zoom').html('<img src="'+a.attr('href')+'">');		if ($(window).width() > 700)			$('.product_popup #zoom').zoom();	} else {		$('#zoom').html('<img src="'+a.attr('href')+'">');		if ($(window).width() > 700)			$('#zoom').zoom();	}	return false;}function send_to_friend() {	if (!$('#send_to_friend [name="name"]').val()) {		func_highlight($('#send_to_friend [name="name"]'));		return false;	}	var r = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;	if (!$('#send_to_friend [name="email"]').val() || !r.test($('#send_to_friend [name="email"]').val())) {		func_highlight($('#send_to_friend [name="email"]'));		return false;	}	if (!$('#send_to_friend [name="friend"]').val() || !r.test($('#send_to_friend [name="friend"]').val())) {		func_highlight($('#send_to_friend [name="friend"]'));		return false;	}	$('#send_to_friend').submit();}function add_review() {	if (!$('#tab-5 [name="rating"]').val()) {		alert('Please, select your rating.');		return false;	}	if (!$('#tab-5 [name="name"]').val()) {		func_highlight($('#tab-5 [name="name"]'));		return false;	}	if (!$('#tab-5 [name="message"]').val()) {		func_highlight($('#tab-5 [name="message"]'));		return false;	}	aload();	$.ajax({		url: window.location.href,		type: 'POST',		data: $('#tab-5 form').serialize()	}).done(function(r) {		unload();		if (r == "1") {			alert("{lng[Please, enter your name and message]}");			return false;		} else if (r == '2') {			recaptchaOnload();			alert("{lng[Captcha is incorrect]}");			return false;		} else if (r == '3') {			recaptchaOnload();			alert("{lng[Your review has been sent to moderation]}");			$('#tab-5 [name="name"]').val('');			$('#tab-5 [name="message"]').val('');			return false;		}	});}function add_wishlist(id) {	$.ajax({		url: current_location+'/wishlist?add='+id	}).done(function(r) {		alert("{lng[Product has been added to your Wishlist]}");	});}function buy_one_click(pid) {	alert("{lng[We will contact you soon]}<br /><input type='text' placeholder='"+lbl_buy1click+"' /> <a class='main-button'>{lng[Send]}</a>", 1, '', 'buy_one_click');	$('.buy_one_click a.main-button').on('click', function() {		var val = $('.buy_one_click input').val();		if (!val)			return false;		$.ajax({			url: current_location+'/buy1click?productid='+pid+'&phone='+val		}).done(function(r) {			$('.buy_one_click').remove();			if (r == 'N') {				alert("{lng[You can require quick sale not more than once per 10 seconds]}");			} else {				alert("{lng[Please, allow us a few minutes to receive your request]}");			}		});		return false;	});}var recaptcha1, recaptcha2, recaptcha3, recaptcha4, recaptcha_reg;function recaptchaOnload() {	if ($('#recaptcha_reviews').length) {		try {			grecaptcha.reset(recaptcha1);		} catch (err) {		}		try {    	  var verifyCallback = function(response) {	      };    	    recaptcha1 = grecaptcha.render(document.getElementById('recaptcha_reviews'), {        	  'sitekey' : $('#recaptcha_reviews').data('sitekey'),	          'callback' : verifyCallback    	    });		} catch (err) {		}	}	if ($('#recaptcha_s2f').length) {		try {			grecaptcha.reset(recaptcha2);		} catch (err) {		}		try {    	  var verifyCallback = function(response) {	      };    	    recaptcha2 = grecaptcha.render(document.getElementById('recaptcha_s2f'), {        	  'sitekey' : $('#recaptcha_s2f').data('sitekey'),	          'callback' : verifyCallback    	    });		} catch (err) {		}	}	if ($('#recaptcha_contact').length) {		try {			grecaptcha.reset(recaptcha3);		} catch (err) {		}		try {    	  var verifyCallback = function(response) {	      };    	    recaptcha3 = grecaptcha.render(document.getElementById('recaptcha_contact'), {        	  'sitekey' : $('#recaptcha_contact').data('sitekey'),	          'callback' : verifyCallback    	    });		} catch (err) {		}	}	if ($('#recaptcha_register').length) {		try {			grecaptcha.reset(recaptcha_reg);		} catch (err) {		}		try {    	  var verifyCallback = function(response) {	      };    	    recaptcha_reg = grecaptcha.render(document.getElementById('recaptcha_register'), {        	  'sitekey' : $('#recaptcha_register').data('sitekey'),	          'callback' : verifyCallback    	    });		} catch (err) {		}	}	if ($('#recaptcha_ticket').length) {		try {			grecaptcha.reset(recaptcha4);		} catch (err) {		}		try {    	  var verifyCallback = function(response) {	      };    	    recaptcha4 = grecaptcha.render(document.getElementById('recaptcha_ticket'), {        	  'sitekey' : $('#recaptcha_ticket').data('sitekey'),	          'callback' : verifyCallback    	    });		} catch (err) {		}	}}